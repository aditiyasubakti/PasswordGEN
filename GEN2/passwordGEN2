#include <stdio.h>
#include <string.h>
#include <ctype.h>

int variantCount(char c) {
    c = tolower(c);
    if (c == 'a' || c == 'b')
        return 4;
    if (c == 'g' || c == 's' || c == 'i' || c == 'e' || c == 'o')
        return 3;
    return 2;   
}

void into(){
	    printf("|===============================|\n"
			   "|\t\tGEN 2\t\t|\n"
			   "|-------------------------------|\n"
			   "|Anda boleh menggunakan alat ini|\n"
			   "|tapi saya tidak bertanggung jaw|\n"
			   "|ab atas tindak ilegal anda.\t|\n"
			   "|===============================|\n"		
			   "   web:aditiyasubakti.my.id\n\n"
		);
}

char getVariant(char c, int idx) {
    char l = tolower(c);

    if (l == 'a') { char v[] = {'a','A','@','4'}; return v[idx]; }
    if (l == 'b') { char v[] = {'b','B','6','8'}; return v[idx]; }
    if (l == 'g') { char v[] = {'g','G','6'}; return v[idx]; }
    if (l == 's') { char v[] = {'s','S','5'}; return v[idx]; }
    if (l == 'i') { char v[] = {'i','I','1'}; return v[idx]; }
    if (l == 'e') { char v[] = {'e','E','3'}; return v[idx]; }
    if (l == 'o') { char v[] = {'o','O','0'}; return v[idx]; }

    return (idx == 0) ? l : toupper(l);
}

int main() {
    char word[50], temp[50];
    int bases[50];
    int len, i, pos;
    long total = 1, mask, x;

    char useNum, useDate;
    int numStart, numEnd;
    char date[9] = "";      
    char numbers[50] = ""; 
    char buf[5];

    FILE *fp = fopen("wordlist.txt", "w");
    if (!fp) {
        printf("Gagal membuat file!\n");
        return 1;
    }

	into();
    printf("Masukkan kata dasar: ");
    scanf("%s", word);

    printf("Tambah angka 1-9 (y/n): ");
    scanf(" %c", &useNum);
    if (useNum == 'y') {
        printf("Masukan angka awal: ");
        scanf("%d", &numStart);
        printf("Masukan angka akhir: ");
        scanf("%d", &numEnd);
        for (i = numStart; i <= numEnd; i++) {
            sprintf(buf, "%d", i);
            strcat(numbers, buf);
        }
    }

    printf("Tambah tanggal lahir (y/n): ");
    scanf(" %c", &useDate);
    if (useDate == 'y') {
        printf("Masukan ddmmyyyy: ");
        scanf("%8s", date);
    }

    len = strlen(word);
    for (i = 0; i < len; i++) {
        bases[i] = variantCount(word[i]);
        total *= bases[i];
    }

    printf("\nTotal kombinasi huruf: %ld\n\n", total);

    /* ===== GENERATE WORDLIST ===== */
    for (mask = 0; mask < total; mask++) {
        x = mask;

        for (pos = 0; pos < len; pos++) {
            int idx = x % bases[pos];
            x /= bases[pos];
            temp[pos] = getVariant(word[pos], idx);
        }
        temp[len] = '\0';

        /* === NORMAL === */
        fprintf(fp, "%s\n", temp);
        printf("%s\n", temp);

        /* === ANGKA (JIKA ADA) === */
        if (useNum == 'y' && strlen(numbers) > 0) {
            fprintf(fp, "%s%s\n", temp, numbers);
            fprintf(fp, "%s%s\n", numbers, temp);
        }

        /* === TANGGAL (JIKA ADA) === */
        if (useDate == 'y' && strlen(date) > 0) {
            fprintf(fp, "%s%s\n", temp, date);
            fprintf(fp, "%s%s\n", date, temp);
        }
    }

    fclose(fp);
    printf("\nSelesai! Wordlist tersimpan di wordlist.txt\n");
    return 0;
}
